{% extends 'base.html.twig' %}

{% block title %}Jeu{% endblock %}

{% block body %}
    <div class="cont-hidden flex-wrap margin-top-0 padding-top-0">
        <div class="cont-title padding-top-0 margin-top-0"><h1>{{ item.name }}
            </h1>
        </div>
        <div class="cont radius-bottom flex-wrap margin-top-0">


            <div style="text-align: start" class="cont-medium radius margin-top-0 padding-top-0"><h3
                        class="padding-0  margin-5" style="text-align: center">Informations
                    interne</h3>
                <p style="text-align: start">
                    Réf produit: <span class="bold">{{ item.id }}</span><br>
                    Réf interne: {% if item.ref %} <span class="bold">{{ item.ref }}</span>{% else %} <span
                        class="bold"> Non renseigné </span> {% endif %}<br>
                    Ajouté le:<span class="bold">  {{ item.registerDateTime|date('d-m-Y') }} </span> <br>
                    Etat
                    d'usure: {% if item.itemCondition %} <span class="bold"> {{ item.itemCondition }} </span> {% else %}
                        <span class="bold">  Non renseigné </span> {% endif %}
                    <br>
                    Complet: {% if item.completeness == 0 %} <span class="bold"> OUI </span> {% else %} <span
                        class="bold"> NON </span> {% endif %}<br>
                    Valeur: {% if item.gamePrice %} <span class="bold"> {{ item.gamePrice }} </span> {% else %} <span
                        class="bold"> Non renseigné </span> {% endif %}<br>


                </p>

            </div>
            <div class="cont-medium radius margin-top-0 padding-top-0"><h3 class="margin-top-0 padding-top-0  margin-5">
                    Informations générales</h3>
                <p style="text-align: start">
                    Langue: {% if item.lang %} <span class="bold"> {{ item.lang }} </span>{% else %} <span class="bold"> Non renseigné </span> {% endif %}
                    <br>
                    Editeur: {% if item.publisher %} <span class="bold"> {{ item.publisher }} </span> <br>  {% else %}
                    <span
                            class="bold"> Non renseigné  </span> {% endif %}<br>
                    Auteur: {% if item.author %} <span class="bold"> {{ item.author }} </span> <br>  {% else %} <span
                        class="bold"> Non renseigné </span> {% endif %}<br>
                    Illustrateur: {% if item.illustrator %}  <span class="bold"> {{ item.illustrator }} </span>
                        <br>  {% else %} <span class="bold"> Non renseigné </span> {% endif %} <br>
                    Age minimum conseillé par l'éditeur: {% if item.PlayerNbMax %} <span
                            class="bold"> {{ item.playerNbMax }} </span>
                        <br>  {% else %} <span class="bold"> Non renseigné </span> {% endif %} <br>
                    Nombre de
                    joueurs: {% if item.playerNbMin and itemPlayerMax %} de <span
                            class="bold"> {{ item.playerNbMin }} </span> à <span
                            class="bold"> {{ item.playerNbMax }} </span> {% else %} <span
                            class="bold"> Non  </span> {% endif %} <br>
                    Catégorie(s):
                    {% for category in item.categories %}
                        <span
                                class="bold"> {{ category }}</span>
                    {% endfor %}
                </p>
                <div class="cont-result"><img src="/img/nb_player.svg"> <small>de {{ item.playerNbMin}} à {{ item.playerNbMax}}</small>
                    | icone | icone | icone | icone | icone |</div>


            </div>

            <div class="cont-medium-height-locked radius scroller margin-top-0 padding-top-0"><h3
                        class="margin-top-0 padding-top-0  margin-5">Historique des prêts</h3>
                {% for loan in item.loans %}

                    {% for relation in loan.family.relationships %}
                        {% if relation.isOwner == 1 %}
                            <div class="padding-5 margin-5 border-1 radius-top-left" style="text-align: start ; background-color: #95D6A4">

                            Famille <span
                                style="font-weight: bold">{{ relation.member.lastName|upper }} </span> {% endif %}
                    {% endfor %}

                    Prété le: {{ loan.startDateTime|date('d-m-Y') }} | <br>
                    {% if loan.effectReturnDateTime %}  rendu le: <span
                            style="color: #25963F">{{ loan.effectReturnDateTime|date('d-m-Y') }}</span> {% else %}retour prévu le:
                        <span style="color: #B0413E">{{ loan.datePreviewBack|date('d-m-Y') }}</span> {% endif %} |
                    rendu complet: {% if loan.completenessReturn == 1 %}  <span
                        style="color: #25963F">OUI</span> {% else %}
                    <span style="color: #B0413E">NON</span> {% endif %}
                    {% if loan.returnComment != null %} {{ loan.returnComment }} {% else %} Aucun commentaire
                    {% endif %}
                    </div>

                {% endfor %}


            </div>

            <div class="cont-medium radius text-center margin-top-0 padding-top-0 relative"><h3
                        class="margin-top-0 padding-top-0 margin-5">Prêt et retour</h3>
                {% if item.available == 1 %}
                    <div class="absolute">
                        <h2>Prêter le jeu à une famille?</h2>
                        <div class="cont-small-hidden flex-justify-center">
                            <form class="text-center" style="width: 300px"
                                  action="{{ path('app_loan_show', {'idItem': item.id }) }}"
                                  method="post"><input
                                        placeholder="Entrez le nom d'une famille"
                                        autocomplete="off"
                                        name="word"
                                        id="loansearchfamily"
                                        type="search"/>

                                <button style="width: 150px  ; font-size: 15px">Rechercher une famille
                                </button>
                            </form>
                        </div>

                    </div>

                {% endif %}
                {% if item.available == 0 and item.completeness == 1 %}

                    <div class="box2">
                        <h2>Le jeu a été prété, effectuer un retour?</h2>

                        <div class="cont-result"><p>Retour prévu: <span
                                        class="bold">{{ loan.datePreviewBack|date('d-m-Y') }}</span> <br>
                                {% if loan.datePreviewBack < "now" %}
                                    <br> <span class="color-red bold">RETARD:
                                 {% for relation in loan.family.relationships %}
                                     {% if relation.isOwner == 1 %}
                                         <a style="text-decoration-style: solid"
                                            href="{{ path('app_family_show', {'idFamily': loan.family }) }}">
                                                     contactez la famille {{ relation.member.lastName|upper }} en cliquant ici
                                        </a>

                                     {% endif %}


                                 {% endfor %}
                                </span>
                                {% endif %}
                            </p>
                            <p>Actuellement chez la famille:
                                {% for relation in loan.family.relationships %}
                                    {% if relation.isOwner == 1 %}
                                        <a href="{{ path('app_family_show', {'idFamily': loan.family }) }}"><span
                                                    class="bold color-blue">{{ relation.member.lastName|upper }} (voir la fiche famille)</span>
                                        </a>

                                    {% endif %}


                                {% endfor %}


                            </p>
                            <div class="cont-small-hidden flex">
                                <form style="width: 300px" action="{{ path('app_loan_return', {'idItem': item.id }) }}"
                                      method="post">
                                    <button
                                            style="width: 100px  ; font-size: 12px">Effectuer le retour de l'article
                                    </button>
                                </form>
                            </div>

                        </div>


                    </div>
                {% endif %}
                {% if item.completeness == 0 %}
                    <div class="box2">
                        <h2>Le jeu est incomplet</h2>
                    </div>
                {% endif %}

            </div>
        </div>

    </div>







{% endblock %}
